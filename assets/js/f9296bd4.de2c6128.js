"use strict";(self.webpackChunkinsights=self.webpackChunkinsights||[]).push([[3210],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>y});var r=a(7294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=r.createContext({}),c=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=c(e.components);return r.createElement(s.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(a),m=n,y=d["".concat(s,".").concat(m)]||d[m]||u[m]||o;return a?r.createElement(y,i(i({ref:t},p),{},{components:a})):r.createElement(y,i({ref:t},p))}));function y(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,i=new Array(o);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:n,i[1]=l;for(var c=2;c<o;c++)i[c]=a[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}m.displayName="MDXCreateElement"},6765:(e,t,a)=>{a.r(t),a.d(t,{Highlight:()=>p,assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var r=a(7462),n=(a(7294),a(3905));const o={id:"Advent of Cyber 2021 Day 22",title:"Day 22",sidebar_label:"Day 22 ~ How It Happened",description:"\u200b[Day 22] ~ How It Happened"},i=void 0,l={unversionedId:"TryHackMe/Advent-Of-Cyber-2021/Modules/Days 19-24 ~ Blue Teaming/Advent of Cyber 2021 Day 22",id:"TryHackMe/Advent-Of-Cyber-2021/Modules/Days 19-24 ~ Blue Teaming/Advent of Cyber 2021 Day 22",title:"Day 22",description:"\u200b[Day 22] ~ How It Happened",source:"@site/docs/02-TryHackMe/Advent-Of-Cyber-2021/Modules/Days 19-24 ~ Blue Teaming/Day 22.mdx",sourceDirName:"02-TryHackMe/Advent-Of-Cyber-2021/Modules/Days 19-24 ~ Blue Teaming",slug:"/TryHackMe/Advent-Of-Cyber-2021/Modules/Days 19-24 ~ Blue Teaming/Advent of Cyber 2021 Day 22",permalink:"/Insights-N-Notes/docs/TryHackMe/Advent-Of-Cyber-2021/Modules/Days 19-24 ~ Blue Teaming/Advent of Cyber 2021 Day 22",draft:!1,tags:[],version:"current",frontMatter:{id:"Advent of Cyber 2021 Day 22",title:"Day 22",sidebar_label:"Day 22 ~ How It Happened",description:"\u200b[Day 22] ~ How It Happened"},sidebar:"mySideBar",previous:{title:"Day 21 ~ Needles In Computer Stacks",permalink:"/Insights-N-Notes/docs/TryHackMe/Advent-Of-Cyber-2021/Modules/Days 19-24 ~ Blue Teaming/Advent of Cyber 2021 Day 21"},next:{title:"Day 23 ~ PowershELlF Magic",permalink:"/Insights-N-Notes/docs/TryHackMe/Advent-Of-Cyber-2021/Modules/Days 19-24 ~ Blue Teaming/Advent of Cyber 2021 Day 23"}},s={},c=[{value:'Day 22 <Highlight color="#6595C4"><span>Blue Teaming</span></Highlight> How It Happened',id:"day-22-blue-teaming-how-it-happened",level:2}],p=e=>{let{children:t,color:a}=e;return(0,n.kt)("span",{style:{backgroundColor:a,borderRadius:"2px",color:"#fff",padding:"0.2rem"}},t)},d={toc:c,Highlight:p};function u(e){let{components:t,...o}=e;return(0,n.kt)("wrapper",(0,r.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"day-22-blue-teaming-how-it-happened"},"[Day 22]"," ",(0,n.kt)(p,{color:"#6595C4",mdxType:"Highlight"},(0,n.kt)("span",null,"Blue Teaming"))," How It Happened"),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"McSkidy has finally gotten around to identifying the first trace of Grinch Enterprises within their network. They're looking at local machines to determine what exactly they did when they first entered the network. Can you help them make sense of what happened?")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Cyberchef is one great tool to use.")),(0,n.kt)("p",null,"Another however, is Oledump."),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"You can think of OLE files as 'a mini file system' or similar to a Zip archive. Applications such as MS Office with extensions .doc, .xls, .ppt are known as OLE files. Malicious actors can abuse macros to hide malicious commands/scripts within Excel and Word documents.")),(0,n.kt)("p",null,'OLE will have a storage that contains the streams of data or other storages. For example, it may descibe what a Word doc looks like "under the hood" so that you can see the stream of data you wouldn\'t normally notice. '),(0,n.kt)("p",null,'An "M" next to a stream dictates a VBA Macro which are made thru Visual Basic for Applications.'),(0,n.kt)("p",null,"Here are some additional useful options to keep in mind:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"}),(0,n.kt)("li",{parentName:"ul"},"-A does an ASCII dump similar to option -a, but duplicate lines are removed."),(0,n.kt)("li",{parentName:"ul"},"-S dumps strings."),(0,n.kt)("li",{parentName:"ul"},"-d produces a raw dump of the stream content. "),(0,n.kt)("li",{parentName:"ul"},"-s STREAM NUMBER or --select=STREAM NUMBER allows you to select the stream number to analyze (-s a to select all streams)"),(0,n.kt)("li",{parentName:"ul"},"-d, --dump - perform a raw dump"),(0,n.kt)("li",{parentName:"ul"},"-x, --hexdump - perform a hex dump"),(0,n.kt)("li",{parentName:"ul"},"-a, --asciidump - perform an ascii dump"),(0,n.kt)("li",{parentName:"ul"},"-S, --strings - perform a strings dump"),(0,n.kt)("li",{parentName:"ul"},"-v, --vbadecompress - VBA decompression")),(0,n.kt)("p",null,"Here's a run of OLE for the file in the machine:\n",(0,n.kt)("img",{alt:"OLE.png",src:a(2153).Z,width:"800",height:"289"}),"  "),(0,n.kt)("p",null,"We follow the demo about the decoding method (from base64, XOR - 35 decimal, from base64 to reveal a more legible text)"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"cyberchef.png",src:a(1845).Z,width:"796",height:"784"}),"  "),(0,n.kt)("p",null,"2nd flag was nudging us to check the pictures folder for the flag\n",(0,n.kt)("img",{alt:"picture.png",src:a(7063).Z,width:"977",height:"816"})))}u.isMDXComponent=!0},2153:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/OLE-57ee24ae97d483fd9d01e30e00b34858.png"},1845:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/cyberchef-47b3961eff9f27ccd8fbf1a05458bddc.png"},7063:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/picture-c1efc4d0ee07b23e5f1d59711898a7bb.png"}}]);