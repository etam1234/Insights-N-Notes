---
id: Advent of Cyber 2021 Day 22
title: Day 22
sidebar_label: Day 22 ~ How It Happened 
description: â€‹[Day 22] ~ How It Happened  
---

export const Highlight = ({children, color}) => (
  <span
    style={{
      backgroundColor: color,
      borderRadius: '2px',
      color: '#fff',
      padding: '0.2rem',
    }}>
    {children}
  </span>
);

## [Day 22] <Highlight color="#6595C4"><span>Blue Teaming</span></Highlight> How It Happened 

>McSkidy has finally gotten around to identifying the first trace of Grinch Enterprises within their network. They're looking at local machines to determine what exactly they did when they first entered the network. Can you help them make sense of what happened?


**Cyberchef is one great tool to use.**

Another however, is Oledump.

>You can think of OLE files as 'a mini file system' or similar to a Zip archive. Applications such as MS Office with extensions .doc, .xls, .ppt are known as OLE files. Malicious actors can abuse macros to hide malicious commands/scripts within Excel and Word documents.

OLE will have a storage that contains the streams of data or other storages. For example, it may descibe what a Word doc looks like "under the hood" so that you can see the stream of data you wouldn't normally notice. 

An "M" next to a stream dictates a VBA Macro which are made thru Visual Basic for Applications.

Here are some additional useful options to keep in mind:
- 
- -A does an ASCII dump similar to option -a, but duplicate lines are removed.
- -S dumps strings.
- -d produces a raw dump of the stream content. 
- -s STREAM NUMBER or --select=STREAM NUMBER allows you to select the stream number to analyze (-s a to select all streams)
- -d, --dump - perform a raw dump
- -x, --hexdump - perform a hex dump
- -a, --asciidump - perform an ascii dump
- -S, --strings - perform a strings dump
- -v, --vbadecompress - VBA decompression

Here's a run of OLE for the file in the machine:
![OLE.png](/img/_resources/Days_19-24/OLE.png)  

We follow the demo about the decoding method (from base64, XOR - 35 decimal, from base64 to reveal a more legible text)

![cyberchef.png](/img/_resources/Days_19-24/cyberchef.png)  

2nd flag was nudging us to check the pictures folder for the flag
![picture.png](/img/_resources/Days_19-24/picture.png)  

